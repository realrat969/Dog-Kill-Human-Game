<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dog Kill Human 1.0</title>
    <style>
        body { background-color: #000011; color: #00ff00; font-family: 'Courier New', Courier, monospace; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        #game-container { position: relative; box-shadow: 0 0 50px rgba(0, 255, 0, 0.2); border: 4px solid #004400; }
        canvas { background-color: #000011; display: block; image-rendering: pixelated; }
        #ui-layer, #pause-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        #pause-layer { background: rgba(0, 0, 34, 0.9); z-index: 100; display: none; pointer-events: auto; }
        h1 { font-size: 70px; color: #00ff00; text-shadow: 0 0 10px #00ff00, 0 0 30px #00ff00; margin-bottom: 20px; }
        h2 { font-size: 50px; color: #00ffff; text-shadow: 0 0 15px #00ffff; margin-bottom: 10px; }
        .stats-text { font-size: 26px; color: #00ffff; margin: 8px 0; letter-spacing: 3px; font-weight: bold; }
        .cash-text { color: #ffff00; text-shadow: 0 0 10px #ffff00; }
        .menu-btn { pointer-events: auto; padding: 15px 40px; font-size: 24px; background: linear-gradient(45deg, #004400, #00aa00); color: white; border: 2px solid #00ff00; cursor: pointer; border-radius: 8px; box-shadow: 0 0 15px #00ff00; transition: all 0.1s; width: 280px; margin: 5px; }
        .menu-btn:hover { transform: translateY(-3px); box-shadow: 0 0 25px #00ff00; }
        .menu-btn:disabled { background: #222; border-color: #444; color: #666; box-shadow: none; cursor: not-allowed; }
        #score-board { position: absolute; top: 15px; left: 15px; font-size: 18px; background: rgba(0, 0, 51, 0.8); padding: 10px 20px; border-left: 5px solid #00ff00; color: #00ff00; display: none; z-index: 50; }
        #controls-hint { position: absolute; right: 20px; bottom: 20px; text-align: right; background: rgba(0, 255, 255, 0.1); padding: 20px; border: 1px solid #00ffff; font-size: 14px; color: #00ffff; }
        .hidden { display: none !important; }
        #level-up-banner, #respawn-banner { position: absolute; top: 35%; width: 100%; text-align: center; font-size: 90px; font-weight: 900; color: #00ffff; text-shadow: 0 0 20px #00ffff; pointer-events: none; opacity: 0; z-index: 80; }
        #level-up-banner.show, #respawn-banner.show { opacity: 1; transform: scale(1.2); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    </style>
</head>
<body>

    <img id="dogImage" src="doggoimage.png" style="display:none;">
    <img id="humanImage" src="person.png" style="display:none;">

    <div id="game-container">
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <div id="level-up-banner">LEVEL UP!</div>
        <div id="respawn-banner">RESPAWNING...</div>
        
        <div id="pause-layer">
            <h2>PAUSED</h2>
            <div class="stats-text">CASH: <span class="cash-text">$<span id="pause-cash">0</span></span></div>
            <div class="stats-text">SCORE: <span id="pause-score">0</span></div>
            <button class="menu-btn" id="resume-btn">RESUME</button>
        </div>

        <div id="ui-layer">
            <h1 id="game-title">DOG KILL HUMAN</h1>
            <div class="stats-text" style="color: #ff00ff;">BEST: <span id="main-high">0</span></div>
            <div id="menu-stats" class="stats-text" style="margin-bottom:20px;">BANK: <span class="cash-text">$<span id="main-cash">0</span></span></div>
            <button class="menu-btn" id="play-btn">PLAY</button>
            <button class="menu-btn hidden" id="revive-btn">REVIVE ($100)</button>
            <div id="controls-hint">
                <b>CONTROLS:</b><br>
                ARROWS / WASD: MOVE<br>
                SPACE: LASERS | B: BOMB<br>
                P: PAUSE 
            </div>
        </div>

        <div id="score-board">
            LIVES: <span id="lives-val">3</span> | LVL: <span id="level-val">1</span> | KILLS: <span id="score-val">0</span> | BOMBS: <span id="bomb-val">0</span>/5 | <span class="cash-text">$<span id="hud-cash">0</span></span>
        </div>
    </div>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playShootSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        if (type === 'minigun') { 
            osc.type = 'sawtooth'; osc.frequency.setValueAtTime(220, audioCtx.currentTime); 
            osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.1); gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
        } else if (type === 'boss') { 
            osc.type = 'square'; osc.frequency.setValueAtTime(110, audioCtx.currentTime); 
            osc.frequency.exponentialRampToValueAtTime(30, audioCtx.currentTime + 0.25); gain.gain.setValueAtTime(0.15, audioCtx.currentTime);
        } else if (type === 'bomb') {
            const bSize = audioCtx.sampleRate * 0.8; const buffer = audioCtx.createBuffer(1, bSize, audioCtx.sampleRate); const data = buffer.getChannelData(0);
            for (let i = 0; i < bSize; i++) data[i] = Math.random() * 2 - 1;
            const noise = audioCtx.createBufferSource(); noise.buffer = buffer; const filter = audioCtx.createBiquadFilter(); filter.type = 'lowpass';
            const bGain = audioCtx.createGain(); bGain.gain.setValueAtTime(0.6, audioCtx.currentTime); noise.connect(filter); filter.connect(bGain); bGain.connect(audioCtx.destination); noise.start(); return;
        } else { 
            osc.type = 'triangle'; osc.frequency.setValueAtTime(440, audioCtx.currentTime); 
            osc.frequency.exponentialRampToValueAtTime(120, audioCtx.currentTime + 0.1); gain.gain.setValueAtTime(0.15, audioCtx.currentTime); 
        }
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1); osc.connect(gain); gain.connect(audioCtx.destination); osc.start(); osc.stop(audioCtx.currentTime + 0.1);
    }

    const canvas = document.getElementById('gameCanvas'), ctx = canvas.getContext('2d');
    const dogImg = document.getElementById('dogImage'), humanImg = document.getElementById('humanImage');
    const uiLayer = document.getElementById('ui-layer'), pauseLayer = document.getElementById('pause-layer');
    const reviveBtn = document.getElementById('revive-btn');

    let gameRunning = false, isPaused = false, isRespawning = false, score = 0, level = 1, bombs = 0, lives = 3;
    let cash = parseInt(localStorage.getItem('dogKillHumanCash')) || 0;
    let lastCashScore = 0, highScore = localStorage.getItem('dogKillHumanHighScore') || 0;
    
    // Set High Score on Main Menu immediately
    document.getElementById('main-high').innerText = highScore;

    const player = { x: 360, y: 500, width: 80, height: 80, speed: 16 };
    let lasers = [], humans = [], bosses = [], particles = [], bossLasers = [], keys = {}, lastShotTime = 0, shootCooldown = 150, bossCount = 0, shakeTimer = 0, flashTimer = 0;

    updateCashUI();

    document.addEventListener('keydown', (e) => { keys[e.code] = true; if (e.code === 'KeyB' && gameRunning && !isPaused && !isRespawning) useBomb(); if (e.code === 'KeyP' && gameRunning && !isRespawning) togglePause(); });
    document.addEventListener('keyup', (e) => { keys[e.code] = false; });
    document.getElementById('play-btn').addEventListener('click', startGame);
    document.getElementById('resume-btn').addEventListener('click', togglePause);
    reviveBtn.addEventListener('click', revivePlayer);

    function updateCashUI() {
        document.getElementById('main-cash').innerText = cash;
        document.getElementById('pause-cash').innerText = cash;
        document.getElementById('hud-cash').innerText = cash;
        localStorage.setItem('dogKillHumanCash', cash);
    }

    function togglePause() { isPaused = !isPaused; if (isPaused) { document.getElementById('pause-score').innerText = score; updateCashUI(); pauseLayer.style.display = 'flex'; } else pauseLayer.style.display = 'none'; }

    function startGame() { 
        gameRunning = true; isPaused = false; isRespawning = false; score = 0; level = 1; bombs = 0; lives = 3; bossCount = 0; lastCashScore = 0;
        player.x = 360; lasers = []; humans = []; bosses = []; particles = []; bossLasers = []; 
        uiLayer.classList.add('hidden'); reviveBtn.classList.add('hidden');
        document.getElementById('score-board').style.display = 'block'; updateCashUI();
        requestAnimationFrame(gameLoop); 
    }

    function revivePlayer() {
        if (cash >= 100) { cash -= 100; lives = 4; gameRunning = true; isPaused = false; isRespawning = false; document.getElementById('lives-val').innerText = lives; uiLayer.classList.add('hidden'); reviveBtn.classList.add('hidden'); document.getElementById('score-board').style.display = 'block'; updateCashUI(); requestAnimationFrame(gameLoop); }
    }

    function handleDeath() {
        lives--; document.getElementById('lives-val').innerText = lives; createExplosion(player.x + 40, player.y + 40, '#00ffff', 40);
        if (lives <= 0) gameOver(); else { isRespawning = true; document.getElementById('respawn-banner').classList.add('show'); setTimeout(() => { isRespawning = false; document.getElementById('respawn-banner').classList.remove('show'); player.x = 360; humans = []; bossLasers = []; }, 2000); }
    }

  function shootLaser() {
    const now = Date.now(); 
    let dynamicCooldown = Math.max(50, shootCooldown - Math.floor(score / 20));

    if (now - lastShotTime > dynamicCooldown) {
            playShootSound(score >= 80 ? 'minigun' : 'gun');
            let currentDmg = 1 + Math.min(Math.floor(score / 50), 20);
            
            if (score >= 40) { 
                lasers.push({ x: player.x + 5, y: player.y, width: 6, height: 20, speed: 20, dmg: currentDmg, color: '#0f0' }); 
                lasers.push({ x: player.x + player.width - 11, y: player.y, width: 6, height: 20, speed: 20, dmg: currentDmg, color: '#0f0' });
            } else lasers.push({ x: player.x + player.width/2 - 3, y: player.y, width: 6, height: 20, speed: 20, dmg: currentDmg, color: '#0f0' });
            
            if (score >= 300) { 
                lasers.push({ x: player.x - 45, y: player.y + 35, width: 4, height: 15, speed: 20, color: '#0ff', dmg: currentDmg }); 
                lasers.push({ x: player.x + player.width + 41, y: player.y + 35, width: 4, height: 15, speed: 20, color: '#0ff', dmg: currentDmg }); 
            }
            lastShotTime = now;
        }
    }

    function useBomb() { 
        if (bombs > 0) { 
            bombs--; document.getElementById('bomb-val').innerText = bombs; shakeTimer = 45; flashTimer = 18; playShootSound('bomb'); bossLasers = []; humans = []; 
            bosses.forEach(b => { b.hp -= 200; b.stunTimer = 180; createExplosion(b.x + b.width/2, b.y + b.height/2, '#0ff', 25); }); 
            for(let i=0; i<60; i++) particles.push({ x: 400, y: 300, vx: (Math.random()-0.5)*35, vy: (Math.random()-0.5)*35, life: 1, color: '#0f0' }); 
        } 
    }
    function createExplosion(x, y, color, count = 10) { for (let i = 0; i < count; i++) particles.push({ x, y, vx: (Math.random()-0.5)*15, vy: (Math.random()-0.5)*15, life: 1, color }); }

    function update() {
        if (!gameRunning || isPaused || isRespawning) return;
        if (keys['ArrowLeft'] || keys['KeyA']) player.x -= player.speed; if (keys['ArrowRight'] || keys['KeyD']) player.x += player.speed; if (keys['Space']) shootLaser();
        player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));
        
        if (score >= lastCashScore + 100) { cash += 10; lastCashScore += 100; updateCashUI(); }

        for (let li = lasers.length - 1; li >= 0; li--) {
            let l = lasers[li];
            l.y -= l.speed; 
            if (l.y < -20) { lasers.splice(li, 1); continue; }

            let hit = false;
            for (let hi = humans.length - 1; hi >= 0; hi--) {
                let h = humans[hi];
                if (l.x < h.x + h.width && l.x + l.width > h.x && l.y < h.y + h.height && l.y + l.height > h.y) { 
                    createExplosion(h.x + h.width/2, h.y + h.height/2, '#0f0', 12); humans.splice(hi, 1); 
                    score++; hit = true;
                    if (score > highScore) { 
                        highScore = score; 
                        localStorage.setItem('dogKillHumanHighScore', highScore); 
                        document.getElementById('main-high').innerText = highScore;
                    } 
                    if (score % 20 === 0) { level++; if (bombs < 5) bombs++; document.getElementById('level-up-banner').classList.add('show'); setTimeout(() => document.getElementById('level-up-banner').classList.remove('show'), 1200); }
                    break;
                }
            }
            if (hit) { lasers.splice(li, 1); continue; }

            bosses.forEach((b) => { 
                if (l.x < b.x + b.width && l.x + l.width > b.x && l.y < b.y + b.height && l.y + l.height > b.y) { 
                    let dmg = l.dmg; if (Math.random() < 0.1) { dmg *= 2; createExplosion(l.x, l.y, '#ffff00', 8); }
                    b.hp -= dmg; hit = true; createExplosion(l.x, l.y, '#0ff', 3); 
                } 
            });
            if (hit) lasers.splice(li, 1);
        }

        if (score > 0 && score % 100 === 0 && bosses.length === 0 && Math.floor(score/100) > bossCount) { 
            bossCount++; let calcHP = Math.min(200 * Math.pow(2, bossCount-1), 10000);
            bosses.push({ x: 300, y: -250, width: 200, height: 200, speed: 0.6, hp: calcHP, maxHp: calcHP, lastFire: 0, stunTimer: 0 }); 
        }

        let spawnChance = 0.012 + (level * 0.005); 
        if (Math.random() < spawnChance && (bosses.length === 0 || score >= 1500)) { 
            let speedTier = Math.min(Math.floor(score / 20), 6); 
            let tierSpeed = 1.5 + (speedTier * 0.5); 
            humans.push({ x: Math.random()*740, y: -60, width: 55, height: 55, speed: tierSpeed }); 
        }
        
        humans.forEach((h, i) => { h.y += h.speed; if (h.y > 600) { handleDeath(); humans.splice(i, 1); return; } if (player.x < h.x + h.width && player.x + player.width > h.x && player.y < h.y + h.height && player.y + player.height > h.y) handleDeath(); });
        bosses.forEach((b, bi) => {
            if (b.stunTimer > 0) { b.stunTimer--; } else {
                let cappedScale = Math.min(score, 500); b.y += b.speed + (cappedScale / 10000); 
                let shootDelay = Math.max(1000, 2500 - (cappedScale * 2));
                if (Date.now() - b.lastFire > shootDelay) { playShootSound('boss'); bossLasers.push({ x: b.x + 85, y: b.y + 190, width: 30, height: 60, speed: 6, vx: (player.x - b.x - 100)/90 }); b.lastFire = Date.now(); }
            }
            if (b.y > 600) handleDeath(); if (b.hp <= 0) { createExplosion(b.x + 100, b.y + 100, '#0ff', 50); bosses.splice(bi, 1); score += 15; } 
        });

        bossLasers.forEach((bl, i) => { bl.y += bl.speed; bl.x += bl.vx || 0; if (bl.y > 600) bossLasers.splice(i, 1); if (bl.x < player.x + player.width && bl.x + bl.width > player.x && bl.y < player.y + player.height && bl.y + bl.height > player.y) handleDeath(); });
        particles.forEach((p, i) => { p.x += p.vx; p.y += p.vy; p.life -= 0.025; if(p.life <= 0) particles.splice(i, 1); });
        if (shakeTimer > 0) shakeTimer--; if (flashTimer > 0) flashTimer--;
        
        document.getElementById('score-val').innerText = score; 
        document.getElementById('level-val').innerText = level;
        document.getElementById('bomb-val').innerText = bombs;
    }

    function draw() { 
        ctx.save(); if (shakeTimer > 0) ctx.translate((Math.random()-0.5)*20, (Math.random()-0.5)*20); 
        ctx.fillStyle = bosses.length > 0 ? '#000033' : '#000011'; ctx.fillRect(0, 0, 800, 600);
        if (!isRespawning) { 
            ctx.drawImage(dogImg, player.x, player.y, player.width, player.height); 
            if (score >= 300) { 
                ctx.drawImage(dogImg, player.x - 65, player.y + 25, 45, 45); 
                ctx.drawImage(dogImg, player.x + 100, player.y + 25, 45, 45); 
            } 
        }
        humans.forEach(h => ctx.drawImage(humanImg, h.x, h.y, h.width, h.height)); 
        bosses.forEach(b => { 
            ctx.drawImage(humanImg, b.x, b.y, b.width, b.height); 
            if (b.stunTimer > 0) { ctx.strokeStyle = '#0ff'; ctx.lineWidth = 4; ctx.strokeRect(b.x, b.y, b.width, b.height); }
            ctx.fillStyle = '#003300'; ctx.fillRect(b.x, b.y - 25, b.width, 12); 
            ctx.fillStyle = '#00ff00'; ctx.fillRect(b.x, b.y - 25, b.width * (Math.max(0, b.hp)/b.maxHp), 12); 
        });
        lasers.forEach(l => { ctx.fillStyle = l.color || '#0f0'; ctx.fillRect(l.x, l.y, l.width, l.height); }); 
        ctx.fillStyle = '#0ff'; bossLasers.forEach(bl => ctx.fillRect(bl.x, bl.y, bl.width, bl.height));
        particles.forEach(p => { ctx.globalAlpha = p.life; ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, 4, 4); }); 
        if (flashTimer > 0) { ctx.fillStyle = `rgba(0,255,0,${flashTimer/18})`; ctx.fillRect(0,0,800,600); } 
        ctx.restore(); 
    }
    function gameLoop() { if (gameRunning) { update(); draw(); requestAnimationFrame(gameLoop); } }
    
    function gameOver() { 
        gameRunning = false; uiLayer.classList.remove('hidden'); 
        document.getElementById('game-title').innerText = "GAME OVER"; 
        document.getElementById('score-board').style.display = 'none'; 
        reviveBtn.classList.remove('hidden'); reviveBtn.disabled = cash < 100; updateCashUI();
        // Update menu High Score again just in case
        document.getElementById('main-high').innerText = highScore;
    }
</script>
</body>
</html>